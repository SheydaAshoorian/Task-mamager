{
    "sourceFile": "apps/frontend/app/dashboard/users/page.tsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 17,
            "patches": [
                {
                    "date": 1771350161932,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1771353385636,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -7,18 +7,18 @@\n   const [users, setUsers] = useState([]);\n   const [loading, setLoading] = useState(true);\n \n   // ۱. گرفتن لیست تمام کاربران\n-  const fetchUsers = async () => {\n-    try {\n-      const response = await axios.get(`${process.env.NEXT_PUBLIC_API_URL}/users`);\n-      setUsers(response.data.data || []);\n-    } catch (error) {\n-      console.error(\"خطا در دریافت کاربران:\", error);\n-    } finally {\n-      setLoading(false);\n-    }\n-  };\n+//   const fetchUsers = async () => {\n+//     try {\n+//       const response = await axios.get(`${process.env.NEXT_PUBLIC_API_URL}/users`);\n+//       setUsers(response.data.data || []);\n+//     } catch (error) {\n+//       console.error(\"خطا در دریافت کاربران:\", error);\n+//     } finally {\n+//       setLoading(false);\n+//     }\n+//   };\n \n   useEffect(() => { fetchUsers(); }, []);\n \n   // ۲. تابع تغییر رول کاربر\n"
                },
                {
                    "date": 1771353441757,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -17,8 +17,18 @@\n //     } finally {\n //       setLoading(false);\n //     }\n //   };\n+    const fetchUsers = async () => {\n+    try {\n+        console.log(\"در حال ارسال درخواست به بک‌اِند...\"); // برای تست در کنسول\n+        const res = await axios.get('http://localhost:3000/users'); \n+        console.log(\"دیتا دریافت شد:\", res.data);\n+        setUsers(res.data);\n+    } catch (error) {\n+        console.error(\"خطا در ارتباط با سرور:\", error);\n+    }\n+    };\n \n   useEffect(() => { fetchUsers(); }, []);\n \n   // ۲. تابع تغییر رول کاربر\n"
                },
                {
                    "date": 1771353563824,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -6,19 +6,9 @@\n export default function UserManagementPage() {\n   const [users, setUsers] = useState([]);\n   const [loading, setLoading] = useState(true);\n \n-  // ۱. گرفتن لیست تمام کاربران\n-//   const fetchUsers = async () => {\n-//     try {\n-//       const response = await axios.get(`${process.env.NEXT_PUBLIC_API_URL}/users`);\n-//       setUsers(response.data.data || []);\n-//     } catch (error) {\n-//       console.error(\"خطا در دریافت کاربران:\", error);\n-//     } finally {\n-//       setLoading(false);\n-//     }\n-//   };\n+\n     const fetchUsers = async () => {\n     try {\n         console.log(\"در حال ارسال درخواست به بک‌اِند...\"); // برای تست در کنسول\n         const res = await axios.get('http://localhost:3000/users'); \n"
                },
                {
                    "date": 1771353668931,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -23,9 +23,9 @@\n \n   // ۲. تابع تغییر رول کاربر\n   const handleRoleChange = async (userId: string, newRole: string) => {\n     try {\n-      await axios.patch(`${process.env.NEXT_PUBLIC_API_URL}/users/${userId}`, {\n+      await axios.patch(`${ttp://localhost:3000//users/${userId}`, {\n         role: newRole\n       });\n       alert(\"نقش کاربر با موفقیت آپدیت شد\");\n       fetchUsers(); // رفرش کردن لیست\n"
                },
                {
                    "date": 1771353694678,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,86 @@\n+\"use client\";\n+import { useEffect, useState } from 'react';\n+import axios from 'axios';\n+import { Users, ShieldCheck, RefreshCw } from 'lucide-react';\n+\n+export default function UserManagementPage() {\n+  const [users, setUsers] = useState([]);\n+  const [loading, setLoading] = useState(true);\n+\n+\n+    const fetchUsers = async () => {\n+    try {\n+        console.log(\"در حال ارسال درخواست به بک‌اِند...\"); // برای تست در کنسول\n+        const res = await axios.get('http://localhost:3000/users'); \n+        console.log(\"دیتا دریافت شد:\", res.data);\n+        setUsers(res.data);\n+    } catch (error) {\n+        console.error(\"خطا در ارتباط با سرور:\", error);\n+    }\n+    };\n+\n+  useEffect(() => { fetchUsers(); }, []);\n+\n+  // ۲. تابع تغییر رول کاربر\n+  const handleRoleChange = async (userId: string, newRole: string) => {\n+    try {\n+      await axios.patch(`${'http://localhost:3000//users/'${userId}`, {\n+        role: newRole\n+      });\n+      alert(\"نقش کاربر با موفقیت آپدیت شد\");\n+      fetchUsers(); // رفرش کردن لیست\n+    } catch (error) {\n+      alert(\"خطا در تغییر نقش\");\n+    }\n+  };\n+\n+  if (loading) return <div className=\"p-10 text-center\">در حال بارگذاری کاربران...</div>;\n+\n+  return (\n+    <div dir=\"rtl\" className=\"p-6\">\n+      <div className=\"flex items-center gap-3 mb-8\">\n+        <Users className=\"text-blue-600\" size={32} />\n+        <h1 className=\"text-2xl font-bold text-gray-800\">مدیریت دسترسی کاربران</h1>\n+      </div>\n+\n+      <div className=\"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden\">\n+        <table className=\"w-full text-right\">\n+          <thead className=\"bg-gray-50 text-gray-600 border-b\">\n+            <tr>\n+              <th className=\"p-4\">نام و نام خانوادگی</th>\n+              <th className=\"p-4\">ایمیل</th>\n+              <th className=\"p-4\">نقش فعلی</th>\n+              <th className=\"p-4\">تغییر سطح دسترسی</th>\n+            </tr>\n+          </thead>\n+          <tbody className=\"divide-y divide-gray-100\">\n+            {users.map((user: any) => (\n+              <tr key={user.id} className=\"hover:bg-gray-50 transition-colors\">\n+                <td className=\"p-4 font-medium\">{user.name} {user.family}</td>\n+                <td className=\"p-4 text-gray-500\">{user.email}</td>\n+                <td className=\"p-4\">\n+                  <span className={`px-3 py-1 rounded-full text-xs font-bold ${\n+                    user.role === 'admin' ? 'bg-purple-100 text-purple-600' : 'bg-blue-100 text-blue-600'\n+                  }`}>\n+                    {user.role === 'admin' ? 'مدیر سیستم' : 'کاربر عادی'}\n+                  </span>\n+                </td>\n+                <td className=\"p-4\">\n+                  <select \n+                    className=\"bg-gray-50 border border-gray-200 rounded-lg p-1 text-sm outline-none focus:border-blue-500\"\n+                    value={user.role}\n+                    onChange={(e) => handleRoleChange(user.id, e.target.value)}\n+                  >\n+                    <option value=\"user\">کاربر عادی (User)</option>\n+                    <option value=\"admin\">مدیر (Admin)</option>\n+                    <option value=\"editor\">ویرایشگر (Editor)</option>\n+                  </select>\n+                </td>\n+              </tr>\n+            ))}\n+          </tbody>\n+        </table>\n+      </div>\n+    </div>\n+  );\n+}\n\\ No newline at end of file\n"
                },
                {
                    "date": 1771353725381,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -23,9 +23,9 @@\n \n   // ۲. تابع تغییر رول کاربر\n   const handleRoleChange = async (userId: string, newRole: string) => {\n     try {\n-      await axios.patch(`${'http://localhost:3000//users/'${userId}`, {\n+      await axios.patch(`${'http://localhost:3000//users/${userId}, {\n         role: newRole\n       });\n       alert(\"نقش کاربر با موفقیت آپدیت شد\");\n       fetchUsers(); // رفرش کردن لیست\n@@ -82,91 +82,5 @@\n         </table>\n       </div>\n     </div>\n   );\n-}\n-\"use client\";\n-import { useEffect, useState } from 'react';\n-import axios from 'axios';\n-import { Users, ShieldCheck, RefreshCw } from 'lucide-react';\n-\n-export default function UserManagementPage() {\n-  const [users, setUsers] = useState([]);\n-  const [loading, setLoading] = useState(true);\n-\n-\n-    const fetchUsers = async () => {\n-    try {\n-        console.log(\"در حال ارسال درخواست به بک‌اِند...\"); // برای تست در کنسول\n-        const res = await axios.get('http://localhost:3000/users'); \n-        console.log(\"دیتا دریافت شد:\", res.data);\n-        setUsers(res.data);\n-    } catch (error) {\n-        console.error(\"خطا در ارتباط با سرور:\", error);\n-    }\n-    };\n-\n-  useEffect(() => { fetchUsers(); }, []);\n-\n-  // ۲. تابع تغییر رول کاربر\n-  const handleRoleChange = async (userId: string, newRole: string) => {\n-    try {\n-      await axios.patch(`${ttp://localhost:3000//users/${userId}`, {\n-        role: newRole\n-      });\n-      alert(\"نقش کاربر با موفقیت آپدیت شد\");\n-      fetchUsers(); // رفرش کردن لیست\n-    } catch (error) {\n-      alert(\"خطا در تغییر نقش\");\n-    }\n-  };\n-\n-  if (loading) return <div className=\"p-10 text-center\">در حال بارگذاری کاربران...</div>;\n-\n-  return (\n-    <div dir=\"rtl\" className=\"p-6\">\n-      <div className=\"flex items-center gap-3 mb-8\">\n-        <Users className=\"text-blue-600\" size={32} />\n-        <h1 className=\"text-2xl font-bold text-gray-800\">مدیریت دسترسی کاربران</h1>\n-      </div>\n-\n-      <div className=\"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden\">\n-        <table className=\"w-full text-right\">\n-          <thead className=\"bg-gray-50 text-gray-600 border-b\">\n-            <tr>\n-              <th className=\"p-4\">نام و نام خانوادگی</th>\n-              <th className=\"p-4\">ایمیل</th>\n-              <th className=\"p-4\">نقش فعلی</th>\n-              <th className=\"p-4\">تغییر سطح دسترسی</th>\n-            </tr>\n-          </thead>\n-          <tbody className=\"divide-y divide-gray-100\">\n-            {users.map((user: any) => (\n-              <tr key={user.id} className=\"hover:bg-gray-50 transition-colors\">\n-                <td className=\"p-4 font-medium\">{user.name} {user.family}</td>\n-                <td className=\"p-4 text-gray-500\">{user.email}</td>\n-                <td className=\"p-4\">\n-                  <span className={`px-3 py-1 rounded-full text-xs font-bold ${\n-                    user.role === 'admin' ? 'bg-purple-100 text-purple-600' : 'bg-blue-100 text-blue-600'\n-                  }`}>\n-                    {user.role === 'admin' ? 'مدیر سیستم' : 'کاربر عادی'}\n-                  </span>\n-                </td>\n-                <td className=\"p-4\">\n-                  <select \n-                    className=\"bg-gray-50 border border-gray-200 rounded-lg p-1 text-sm outline-none focus:border-blue-500\"\n-                    value={user.role}\n-                    onChange={(e) => handleRoleChange(user.id, e.target.value)}\n-                  >\n-                    <option value=\"user\">کاربر عادی (User)</option>\n-                    <option value=\"admin\">مدیر (Admin)</option>\n-                    <option value=\"editor\">ویرایشگر (Editor)</option>\n-                  </select>\n-                </td>\n-              </tr>\n-            ))}\n-          </tbody>\n-        </table>\n-      </div>\n-    </div>\n-  );\n }\n\\ No newline at end of file\n"
                },
                {
                    "date": 1771353737825,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -23,9 +23,9 @@\n \n   // ۲. تابع تغییر رول کاربر\n   const handleRoleChange = async (userId: string, newRole: string) => {\n     try {\n-      await axios.patch(`${'http://localhost:3000//users/${userId}, {\n+      await axios.patch(`${'http://localhost:3000//users/${userId}), {\n         role: newRole\n       });\n       alert(\"نقش کاربر با موفقیت آپدیت شد\");\n       fetchUsers(); // رفرش کردن لیست\n"
                },
                {
                    "date": 1771353750026,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -23,9 +23,9 @@\n \n   // ۲. تابع تغییر رول کاربر\n   const handleRoleChange = async (userId: string, newRole: string) => {\n     try {\n-      await axios.patch(`${'http://localhost:3000//users/${userId}), {\n+      await axios.patch(`${ttp://localhost:3000//users/${userId}`, {\n         role: newRole\n       });\n       alert(\"نقش کاربر با موفقیت آپدیت شد\");\n       fetchUsers(); // رفرش کردن لیست\n"
                },
                {
                    "date": 1771353846210,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -23,11 +23,9 @@\n \n   // ۲. تابع تغییر رول کاربر\n   const handleRoleChange = async (userId: string, newRole: string) => {\n     try {\n-      await axios.patch(`${ttp://localhost:3000//users/${userId}`, {\n-        role: newRole\n-      });\n+\n       alert(\"نقش کاربر با موفقیت آپدیت شد\");\n       fetchUsers(); // رفرش کردن لیست\n     } catch (error) {\n       alert(\"خطا در تغییر نقش\");\n"
                },
                {
                    "date": 1771353956610,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -43,15 +43,16 @@\n \n       <div className=\"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden\">\n         <table className=\"w-full text-right\">\n           <thead className=\"bg-gray-50 text-gray-600 border-b\">\n-            <tr>\n-              <th className=\"p-4\">نام و نام خانوادگی</th>\n-              <th className=\"p-4\">ایمیل</th>\n-              <th className=\"p-4\">نقش فعلی</th>\n-              <th className=\"p-4\">تغییر سطح دسترسی</th>\n-            </tr>\n-          </thead>\n+<thead className=\"bg-blue-600 text-white\">\n+  <tr>\n+    <th className=\"p-4 text-sm font-semibold text-right\">عنوان تسک</th>\n+    <th className=\"p-4 text-sm font-semibold text-right\">ارجاع به</th>\n+    <th className=\"p-4 text-sm font-semibold text-right\">اولویت</th>\n+    {/* هر توضیح یا کامنت دیگری را بیرون از تگ tr قرار بده */}\n+  </tr>\n+</thead>\n           <tbody className=\"divide-y divide-gray-100\">\n             {users.map((user: any) => (\n               <tr key={user.id} className=\"hover:bg-gray-50 transition-colors\">\n                 <td className=\"p-4 font-medium\">{user.name} {user.family}</td>\n"
                },
                {
                    "date": 1771354148681,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,85 +1,16 @@\n \"use client\";\n-import { useEffect, useState } from 'react';\n+import React, { useEffect, useState } from 'react';\n import axios from 'axios';\n-import { Users, ShieldCheck, RefreshCw } from 'lucide-react';\n+import { Users, ShieldCheck } from 'lucide-react';\n \n-export default function UserManagementPage() {\n-  const [users, setUsers] = useState([]);\n-  const [loading, setLoading] = useState(true);\n+interface User {\n+  id: number;\n+  firstName: string;\n+  lastName: string;\n+  email: string;\n+  role: string;\n+}\n \n-\n-    const fetchUsers = async () => {\n-    try {\n-        console.log(\"در حال ارسال درخواست به بک‌اِند...\"); // برای تست در کنسول\n-        const res = await axios.get('http://localhost:3000/users'); \n-        console.log(\"دیتا دریافت شد:\", res.data);\n-        setUsers(res.data);\n-    } catch (error) {\n-        console.error(\"خطا در ارتباط با سرور:\", error);\n-    }\n-    };\n-\n-  useEffect(() => { fetchUsers(); }, []);\n-\n-  // ۲. تابع تغییر رول کاربر\n-  const handleRoleChange = async (userId: string, newRole: string) => {\n-    try {\n-\n-      alert(\"نقش کاربر با موفقیت آپدیت شد\");\n-      fetchUsers(); // رفرش کردن لیست\n-    } catch (error) {\n-      alert(\"خطا در تغییر نقش\");\n-    }\n-  };\n-\n-  if (loading) return <div className=\"p-10 text-center\">در حال بارگذاری کاربران...</div>;\n-\n-  return (\n-    <div dir=\"rtl\" className=\"p-6\">\n-      <div className=\"flex items-center gap-3 mb-8\">\n-        <Users className=\"text-blue-600\" size={32} />\n-        <h1 className=\"text-2xl font-bold text-gray-800\">مدیریت دسترسی کاربران</h1>\n-      </div>\n-\n-      <div className=\"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden\">\n-        <table className=\"w-full text-right\">\n-          <thead className=\"bg-gray-50 text-gray-600 border-b\">\n-<thead className=\"bg-blue-600 text-white\">\n-  <tr>\n-    <th className=\"p-4 text-sm font-semibold text-right\">عنوان تسک</th>\n-    <th className=\"p-4 text-sm font-semibold text-right\">ارجاع به</th>\n-    <th className=\"p-4 text-sm font-semibold text-right\">اولویت</th>\n-    {/* هر توضیح یا کامنت دیگری را بیرون از تگ tr قرار بده */}\n-  </tr>\n-</thead>\n-          <tbody className=\"divide-y divide-gray-100\">\n-            {users.map((user: any) => (\n-              <tr key={user.id} className=\"hover:bg-gray-50 transition-colors\">\n-                <td className=\"p-4 font-medium\">{user.name} {user.family}</td>\n-                <td className=\"p-4 text-gray-500\">{user.email}</td>\n-                <td className=\"p-4\">\n-                  <span className={`px-3 py-1 rounded-full text-xs font-bold ${\n-                    user.role === 'admin' ? 'bg-purple-100 text-purple-600' : 'bg-blue-100 text-blue-600'\n-                  }`}>\n-                    {user.role === 'admin' ? 'مدیر سیستم' : 'کاربر عادی'}\n-                  </span>\n-                </td>\n-                <td className=\"p-4\">\n-                  <select \n-                    className=\"bg-gray-50 border border-gray-200 rounded-lg p-1 text-sm outline-none focus:border-blue-500\"\n-                    value={user.role}\n-                    onChange={(e) => handleRoleChange(user.id, e.target.value)}\n-                  >\n-                    <option value=\"user\">کاربر عادی (User)</option>\n-                    <option value=\"admin\">مدیر (Admin)</option>\n-                    <option value=\"editor\">ویرایشگر (Editor)</option>\n-                  </select>\n\\ No newline at end of file\n-                </td>\n-              </tr>\n-            ))}\n-          </tbody>\n-        </table>\n-      </div>\n-    </div>\n-  );\n-}\n+export default function UsersManagement() {\n+  const [users, setUsers] = useState<User[]>([]);\n+  const [loading, setLoading] = useState(\n\\ No newline at end of file\n"
                },
                {
                    "date": 1771354168399,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -12,5 +12,84 @@\n }\n \n export default function UsersManagement() {\n   const [users, setUsers] = useState<User[]>([]);\n-  const [loading, setLoading] = useState(\n\\ No newline at end of file\n+  const [loading, setLoading] = useState(true);\n+\n+  const fetchUsers = async () => {\n+    try {\n+      setLoading(true);\n+      // آدرس مستقیم برای اطمینان از برقراری ارتباط\n+      const res = await axios.get('http://localhost:3000/users');\n+      setUsers(res.data);\n+    } catch (error) {\n+      console.error(\"خطا در دریافت کاربران:\", error);\n+    } finally {\n+      setLoading(false);\n+    }\n+  };\n+\n+  useEffect(() => {\n+    fetchUsers();\n+  }, []);\n+\n+  const handleRoleChange = async (userId: number, newRole: string) => {\n+    try {\n+      await axios.patch(`http://localhost:3000/users/${userId}/role`, {\n+        role: newRole\n+      });\n+      alert(\"نقش کاربر تغییر کرد ✅\");\n+      fetchUsers();\n+    } catch (error) {\n+      alert(\"خطا در آپدیت نقش ❌\");\n+    }\n+  };\n+\n+  if (loading) return <div className=\"text-center p-10\">در حال بارگذاری کاربران...</div>;\n+\n+  return (\n+    <div className=\"p-6\" dir=\"rtl\">\n+      <div className=\"flex items-center gap-3 mb-8\">\n+        <Users className=\"text-blue-600\" size={32} />\n+        <h1 className=\"text-2xl font-bold text-gray-800\">مدیریت دسترسی کاربران</h1>\n+      </div>\n+\n+      <div className=\"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden\">\n+        <table className=\"w-full text-right border-collapse\">\n+          <thead className=\"bg-gray-50 text-gray-600 border-b border-gray-100\">\n+            <tr>\n+              <th className=\"p-4 font-semibold\">نام و نام خانوادگی</th>\n+              <th className=\"p-4 font-semibold\">ایمیل</th>\n+              <th className=\"p-4 font-semibold\">نقش فعلی</th>\n+              <th className=\"p-4 font-semibold\">تغییر سطح دسترسی</th>\n+            </tr>\n+          </thead>\n+          <tbody className=\"divide-y divide-gray-50\">\n+            {users.map((user) => (\n+              <tr key={user.id} className=\"hover:bg-blue-50/30 transition-colors\">\n+                <td className=\"p-4 text-gray-700\">{user.firstName} {user.lastName}</td>\n+                <td className=\"p-4 text-gray-500 text-sm\">{user.email}</td>\n+                <td className=\"p-4\">\n+                  <span className={`px-3 py-1 rounded-full text-xs font-medium ${\n+                    user.role === 'admin' ? 'bg-purple-100 text-purple-700' : 'bg-blue-100 text-blue-700'\n+                  }`}>\n+                    {user.role}\n+                  </span>\n+                </td>\n+                <td className=\"p-4\">\n+                  <select \n+                    value={user.role}\n+                    onChange={(e) => handleRoleChange(user.id, e.target.value)}\n+                    className=\"bg-gray-50 border border-gray-200 text-gray-700 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2\"\n+                  >\n+                    <option value=\"user\">کارشناس (User)</option>\n+                    <option value=\"admin\">مدیر (Admin)</option>\n+                  </select>\n+                </td>\n+              </tr>\n+            ))}\n+          </tbody>\n+        </table>\n+      </div>\n+    </div>\n+  );\n+}\n\\ No newline at end of file\n"
                },
                {
                    "date": 1771354275821,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,28 +2,24 @@\n import React, { useEffect, useState } from 'react';\n import axios from 'axios';\n import { Users, ShieldCheck } from 'lucide-react';\n \n-interface User {\n-  id: number;\n-  firstName: string;\n-  lastName: string;\n-  email: string;\n-  role: string;\n-}\n-\n export default function UsersManagement() {\n-  const [users, setUsers] = useState<User[]>([]);\n+  // مقدار اولیه را آرایه خالی بگذار\n+  const [users, setUsers] = useState<any[]>([]);\n   const [loading, setLoading] = useState(true);\n \n   const fetchUsers = async () => {\n     try {\n       setLoading(true);\n-      // آدرس مستقیم برای اطمینان از برقراری ارتباط\n       const res = await axios.get('http://localhost:3000/users');\n-      setUsers(res.data);\n+      \n+      // مهم: مطمئن شویم که دیتا حتماً آرایه است\n+      const data = Array.isArray(res.data) ? res.data : (res.data?.data || []);\n+      setUsers(data);\n     } catch (error) {\n       console.error(\"خطا در دریافت کاربران:\", error);\n+      setUsers([]); // در صورت خطا آرایه را خالی کن\n     } finally {\n       setLoading(false);\n     }\n   };\n@@ -63,31 +59,38 @@\n               <th className=\"p-4 font-semibold\">تغییر سطح دسترسی</th>\n             </tr>\n           </thead>\n           <tbody className=\"divide-y divide-gray-50\">\n-            {users.map((user) => (\n-              <tr key={user.id} className=\"hover:bg-blue-50/30 transition-colors\">\n-                <td className=\"p-4 text-gray-700\">{user.firstName} {user.lastName}</td>\n-                <td className=\"p-4 text-gray-500 text-sm\">{user.email}</td>\n-                <td className=\"p-4\">\n-                  <span className={`px-3 py-1 rounded-full text-xs font-medium ${\n-                    user.role === 'admin' ? 'bg-purple-100 text-purple-700' : 'bg-blue-100 text-blue-700'\n-                  }`}>\n-                    {user.role}\n-                  </span>\n-                </td>\n-                <td className=\"p-4\">\n-                  <select \n-                    value={user.role}\n-                    onChange={(e) => handleRoleChange(user.id, e.target.value)}\n-                    className=\"bg-gray-50 border border-gray-200 text-gray-700 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2\"\n-                  >\n-                    <option value=\"user\">کارشناس (User)</option>\n-                    <option value=\"admin\">مدیر (Admin)</option>\n-                  </select>\n-                </td>\n+            {/* چک کردن دوباره برای جلوگیری از ارور map */}\n+            {users && users.length > 0 ? (\n+              users.map((user: any) => (\n+                <tr key={user.id} className=\"hover:bg-blue-50/30 transition-colors\">\n+                  <td className=\"p-4 text-gray-700\">{user.firstName} {user.lastName}</td>\n+                  <td className=\"p-4 text-gray-500 text-sm\">{user.email}</td>\n+                  <td className=\"p-4\">\n+                    <span className={`px-3 py-1 rounded-full text-xs font-medium ${\n+                      user.role === 'admin' ? 'bg-purple-100 text-purple-700' : 'bg-blue-100 text-blue-700'\n+                    }`}>\n+                      {user.role}\n+                    </span>\n+                  </td>\n+                  <td className=\"p-4\">\n+                    <select \n+                      value={user.role}\n+                      onChange={(e) => handleRoleChange(user.id, e.target.value)}\n+                      className=\"bg-gray-50 border border-gray-200 text-gray-700 text-sm rounded-lg p-2\"\n+                    >\n+                      <option value=\"user\">کارشناس (User)</option>\n+                      <option value=\"admin\">مدیر (Admin)</option>\n+                    </select>\n+                  </td>\n+                </tr>\n+              ))\n+            ) : (\n+              <tr>\n+                <td colSpan={4} className=\"text-center p-10 text-gray-400\">هیچ کاربری پیدا نشد.</td>\n               </tr>\n-            ))}\n+            )}\n           </tbody>\n         </table>\n       </div>\n     </div>\n"
                },
                {
                    "date": 1771354782884,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -63,9 +63,9 @@\n             {/* چک کردن دوباره برای جلوگیری از ارور map */}\n             {users && users.length > 0 ? (\n               users.map((user: any) => (\n                 <tr key={user.id} className=\"hover:bg-blue-50/30 transition-colors\">\n-                  <td className=\"p-4 text-gray-700\">{user.firstName} {user.lastName}</td>\n+                  <td className=\"p-4 text-gray-700\">{user.tName} {user.lastName}</td>\n                   <td className=\"p-4 text-gray-500 text-sm\">{user.email}</td>\n                   <td className=\"p-4\">\n                     <span className={`px-3 py-1 rounded-full text-xs font-medium ${\n                       user.role === 'admin' ? 'bg-purple-100 text-purple-700' : 'bg-blue-100 text-blue-700'\n"
                },
                {
                    "date": 1771354789343,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -63,9 +63,9 @@\n             {/* چک کردن دوباره برای جلوگیری از ارور map */}\n             {users && users.length > 0 ? (\n               users.map((user: any) => (\n                 <tr key={user.id} className=\"hover:bg-blue-50/30 transition-colors\">\n-                  <td className=\"p-4 text-gray-700\">{user.tName} {user.lastName}</td>\n+                  <td className=\"p-4 text-gray-700\">{user.tName} {user.}</td>\n                   <td className=\"p-4 text-gray-500 text-sm\">{user.email}</td>\n                   <td className=\"p-4\">\n                     <span className={`px-3 py-1 rounded-full text-xs font-medium ${\n                       user.role === 'admin' ? 'bg-purple-100 text-purple-700' : 'bg-blue-100 text-blue-700'\n"
                },
                {
                    "date": 1771354797594,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -63,9 +63,9 @@\n             {/* چک کردن دوباره برای جلوگیری از ارور map */}\n             {users && users.length > 0 ? (\n               users.map((user: any) => (\n                 <tr key={user.id} className=\"hover:bg-blue-50/30 transition-colors\">\n-                  <td className=\"p-4 text-gray-700\">{user.tName} {user.}</td>\n+                  <td className=\"p-4 text-gray-700\">{user.name} {user.family}</td>\n                   <td className=\"p-4 text-gray-500 text-sm\">{user.email}</td>\n                   <td className=\"p-4\">\n                     <span className={`px-3 py-1 rounded-full text-xs font-medium ${\n                       user.role === 'admin' ? 'bg-purple-100 text-purple-700' : 'bg-blue-100 text-blue-700'\n"
                },
                {
                    "date": 1771354972218,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -27,20 +27,23 @@\n   useEffect(() => {\n     fetchUsers();\n   }, []);\n \n-  const handleRoleChange = async (userId: number, newRole: string) => {\n-    try {\n-      await axios.patch(`http://localhost:3000/users/${userId}/role`, {\n-        role: newRole\n-      });\n-      alert(\"نقش کاربر تغییر کرد ✅\");\n-      fetchUsers();\n-    } catch (error) {\n-      alert(\"خطا در آپدیت نقش ❌\");\n-    }\n-  };\n+const handleRoleChange = async (userId: number, newRole: string) => {\n+  try {\n+    // آدرس را از /users/${userId}/role به /users/${userId} تغییر بده\n+    await axios.patch(`http://localhost:3000/users/${userId}`, {\n+      role: newRole\n+    });\n \n+    alert(\"نقش با موفقیت تغییر کرد ✅\");\n+    fetchUsers(); \n+  } catch (error) {\n+    console.error(error);\n+    alert(\"خطا در تغییر نقش ❌\");\n+  }\n+};\n+\n   if (loading) return <div className=\"text-center p-10\">در حال بارگذاری کاربران...</div>;\n \n   return (\n     <div className=\"p-6\" dir=\"rtl\">\n"
                }
            ],
            "date": 1771350161932,
            "name": "Commit-0",
            "content": "\"use client\";\nimport { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport { Users, ShieldCheck, RefreshCw } from 'lucide-react';\n\nexport default function UserManagementPage() {\n  const [users, setUsers] = useState([]);\n  const [loading, setLoading] = useState(true);\n\n  // ۱. گرفتن لیست تمام کاربران\n  const fetchUsers = async () => {\n    try {\n      const response = await axios.get(`${process.env.NEXT_PUBLIC_API_URL}/users`);\n      setUsers(response.data.data || []);\n    } catch (error) {\n      console.error(\"خطا در دریافت کاربران:\", error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => { fetchUsers(); }, []);\n\n  // ۲. تابع تغییر رول کاربر\n  const handleRoleChange = async (userId: string, newRole: string) => {\n    try {\n      await axios.patch(`${process.env.NEXT_PUBLIC_API_URL}/users/${userId}`, {\n        role: newRole\n      });\n      alert(\"نقش کاربر با موفقیت آپدیت شد\");\n      fetchUsers(); // رفرش کردن لیست\n    } catch (error) {\n      alert(\"خطا در تغییر نقش\");\n    }\n  };\n\n  if (loading) return <div className=\"p-10 text-center\">در حال بارگذاری کاربران...</div>;\n\n  return (\n    <div dir=\"rtl\" className=\"p-6\">\n      <div className=\"flex items-center gap-3 mb-8\">\n        <Users className=\"text-blue-600\" size={32} />\n        <h1 className=\"text-2xl font-bold text-gray-800\">مدیریت دسترسی کاربران</h1>\n      </div>\n\n      <div className=\"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden\">\n        <table className=\"w-full text-right\">\n          <thead className=\"bg-gray-50 text-gray-600 border-b\">\n            <tr>\n              <th className=\"p-4\">نام و نام خانوادگی</th>\n              <th className=\"p-4\">ایمیل</th>\n              <th className=\"p-4\">نقش فعلی</th>\n              <th className=\"p-4\">تغییر سطح دسترسی</th>\n            </tr>\n          </thead>\n          <tbody className=\"divide-y divide-gray-100\">\n            {users.map((user: any) => (\n              <tr key={user.id} className=\"hover:bg-gray-50 transition-colors\">\n                <td className=\"p-4 font-medium\">{user.name} {user.family}</td>\n                <td className=\"p-4 text-gray-500\">{user.email}</td>\n                <td className=\"p-4\">\n                  <span className={`px-3 py-1 rounded-full text-xs font-bold ${\n                    user.role === 'admin' ? 'bg-purple-100 text-purple-600' : 'bg-blue-100 text-blue-600'\n                  }`}>\n                    {user.role === 'admin' ? 'مدیر سیستم' : 'کاربر عادی'}\n                  </span>\n                </td>\n                <td className=\"p-4\">\n                  <select \n                    className=\"bg-gray-50 border border-gray-200 rounded-lg p-1 text-sm outline-none focus:border-blue-500\"\n                    value={user.role}\n                    onChange={(e) => handleRoleChange(user.id, e.target.value)}\n                  >\n                    <option value=\"user\">کاربر عادی (User)</option>\n                    <option value=\"admin\">مدیر (Admin)</option>\n                    <option value=\"editor\">ویرایشگر (Editor)</option>\n                  </select>\n                </td>\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      </div>\n    </div>\n  );\n}"
        }
    ]
}