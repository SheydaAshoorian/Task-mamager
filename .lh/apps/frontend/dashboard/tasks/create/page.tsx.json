{
    "sourceFile": "apps/frontend/dashboard/tasks/create/page.tsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1771265134136,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1771265134136,
            "name": "Commit-0",
            "content": "'use client';\nimport { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { ToastContainer, toast } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\n\nexport default function CreateTaskPage() {\n  const [users, setUsers] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [formData, setFormData] = useState({\n    title: '',\n    description: '',\n    priority: 'Medium',\n    deadline: '',\n    assignedToId: ''\n  });\n\n  // ۱. دریافت لیست یوزرهای واقعی از بک‌اِند (۳۰۰۰)\n  useEffect(() => {\n    axios.get('http://localhost:3000/users')\n      .then(res => {\n        // با توجه به خروجی که فرستادی، دیتا داخل res.data.data است\n        setUsers(res.data.data || res.data);\n      })\n      .catch(err => toast.error('خطا در دریافت لیست پرسنل'));\n  }, []);\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setLoading(true);\n    try {\n      // ارسال دیتا به بک‌اِند\n      await axios.post('http://localhost:3000/tasks', {\n        ...formData,\n        assignedToId: Number(formData.assignedToId)\n      });\n      toast.success('تسک با موفقیت تعریف و ارجاع داده شد');\n      setFormData({ title: '', description: '', priority: 'Medium', deadline: '', assignedToId: '' });\n    } catch (error: any) {\n      toast.error(error.response?.data?.message || 'خطا در ثبت تسک');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 p-4 md:p-8\" dir=\"rtl\">\n      <ToastContainer position=\"top-center\" />\n      \n      <div className=\"max-w-3xl mx-auto bg-white rounded-3xl shadow-xl overflow-hidden border border-gray-100\">\n        {/* Header */}\n        <div className=\"bg-gradient-to-r from-blue-600 to-indigo-700 p-8 text-white\">\n          <h1 className=\"text-3xl font-bold\">تعریف تسک جدید</h1>\n          <p className=\"mt-2 opacity-80 text-sm\">مدیریت و ارجاع وظایف به پرسنل دپارتمان‌ها</p>\n        </div>\n\n        <form onSubmit={handleSubmit} className=\"p-8 space-y-6\">\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n            \n            {/* Title */}\n            <div className=\"md:col-span-2\">\n              <label className=\"block text-sm font-semibold text-gray-700 mb-2\">عنوان تسک</label>\n              <input \n                required\n                className=\"w-full px-4 py-3 rounded-xl bg-gray-50 border border-gray-200 focus:border-blue-500 focus:ring-4 focus:ring-blue-100 transition-all outline-none\"\n                placeholder=\"مثلاً: طراحی رابط کاربری بخش تیکتینگ\"\n                value={formData.title}\n                onChange={e => setFormData({...formData, title: e.target.value})}\n              />\n            </div>\n\n            {/* Assigned To (Dynamic Dropdown) */}\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-700 mb-2\">ارجاع به (کارشناس)</label>\n              <select \n                required\n                className=\"w-full px-4 py-3 rounded-xl bg-gray-50 border border-gray-200 focus:border-blue-500 outline-none\"\n                value={formData.assignedToId}\n                onChange={e => setFormData({...formData, assignedToId: e.target.value})}\n              >\n                <option value=\"\">انتخاب کنید...</option>\n                {users.map((user: any) => (\n                  <option key={user.id} value={user.id}>\n                    {user.name} {user.family} ({user.role})\n                  </option>\n                ))}\n              </select>\n            </div>\n\n            {/* Priority */}\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-700 mb-2\">اولویت</label>\n              <select \n                className=\"w-full px-4 py-3 rounded-xl bg-gray-50 border border-gray-200 focus:border-blue-500 outline-none\"\n                value={formData.priority}\n                onChange={e => setFormData({...formData, priority: e.target.value})}\n              >\n                <option value=\"Low\">کم (Low)</option>\n                <option value=\"Medium\">متوسط (Medium)</option>\n                <option value=\"High\">بالا (High)</option>\n              </select>\n            </div>\n\n            {/* Deadline */}\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-700 mb-2\">مهلت انجام (Deadline)</label>\n              <input \n                type=\"datetime-local\"\n                className=\"w-full px-4 py-3 rounded-xl bg-gray-50 border border-gray-200 focus:border-blue-500 outline-none\"\n                value={formData.deadline}\n                onChange={e => setFormData({...formData, deadline: e.target.value})}\n              />\n            </div>\n\n            {/* Description */}\n            <div className=\"md:col-span-2\">\n              <label className=\"block text-sm font-semibold text-gray-700 mb-2\">توضیحات تکمیلی</label>\n              <textarea \n                rows={4}\n                className=\"w-full px-4 py-3 rounded-xl bg-gray-50 border border-gray-200 focus:border-blue-500 outline-none\"\n                placeholder=\"جزئیات تسک را اینجا بنویسید...\"\n                value={formData.description}\n                onChange={e => setFormData({...formData, description: e.target.value})}\n              />\n            </div>\n          </div>\n\n          <button \n            disabled={loading}\n            className=\"w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 rounded-2xl shadow-lg shadow-blue-200 transition-all transform active:scale-95 disabled:bg-gray-400\"\n          >\n            {loading ? 'در حال ثبت...' : 'ثبت و ابلاغ تسک'}\n          </button>\n        </form>\n      </div>\n    </div>\n  );\n}"
        }
    ]
}